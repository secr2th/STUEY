import React, { useState, useEffect } from 'react';
import { CheckCircle2, Circle, Star, TrendingUp, BookOpen, Calendar, Settings, Home, Award, Target } from 'lucide-react';

/**
 * ê·¸ë¦¼ ê³µë¶€ ê²Œì´ë¯¸í”¼ì¼€ì´ì…˜ ì•±
 * ADHD ì„±ì¸ ì—¬ì„±ì„ ìœ„í•œ êµ¬ì¡°í™”ëœ í•™ìŠµ ì§€ì› ì‹œìŠ¤í…œ
 * 
 * ì£¼ìš” ê¸°ëŠ¥:
 * 1. AI ê¸°ë°˜ ê°œì¸í™”ëœ í•™ìŠµ í”Œëœ ìƒì„±
 * 2. ì‹¤ë ¥ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë° ì§„ë‹¨
 * 3. ì¼ì¼/ì£¼ê°„ ê³¼ì œ ê´€ë¦¬
 * 4. ê°•ì /ì•½ì  ë¶„ì„
 * 5. í•™ìŠµ ë¦¬ì†ŒìŠ¤ ì¶”ì²œ
 * 6. ì§„í–‰ë„ íŠ¸ë˜í‚¹ ë° ë³´ìƒ ì‹œìŠ¤í…œ
 */

// ============================================
// ë°ì´í„° ëª¨ë¸ ë° íƒ€ì… ì •ì˜
// ============================================

const SKILL_CATEGORIES = {
  basic: {
    name: 'ê¸°ì´ˆ ë“œë¡œì‰',
    skills: [
      'ì„  ê¸‹ê¸° (ì§ì„ , ê³¡ì„ )',
      'ë„í˜• ê·¸ë¦¬ê¸° (ì›, ì‚¬ê°í˜•, ì‚¼ê°í˜•)',
      'ë¹„ìœ¨ê³¼ ì¸¡ì •',
      'ê´€ì°° ë“œë¡œì‰',
    ]
  },
  anatomy: {
    name: 'ì¸ì²´ í•´ë¶€í•™',
    skills: [
      'ì–¼êµ´ ë¹„ìœ¨',
      'í‘œì • ê·¸ë¦¬ê¸°',
      'ì† ê·¸ë¦¬ê¸°',
      'ë°œ ê·¸ë¦¬ê¸°',
      'ì „ì‹  ë¹„ìœ¨',
      'ë™ì„¸ (ì œìŠ¤ì²˜)',
    ]
  },
  perspective: {
    name: 'ì›ê·¼ë²•',
    skills: [
      '1ì  íˆ¬ì‹œ',
      '2ì  íˆ¬ì‹œ',
      '3ì  íˆ¬ì‹œ',
      'ë°°ê²½ ê·¸ë¦¬ê¸°',
    ]
  },
  shading: {
    name: 'ëª…ì•”ê³¼ ì§ˆê°',
    skills: [
      'ë¹›ê³¼ ê·¸ë¦¼ì ì´í•´',
      'í†¤ í‘œí˜„',
      'ì§ˆê° í‘œí˜„',
      'ë°˜ì‚¬ê´‘',
    ]
  },
  color: {
    name: 'ìƒ‰ì±„ ì´ë¡ ',
    skills: [
      'ìƒ‰ìƒí™˜ ì´í•´',
      'ìƒ‰ ì¡°í•©',
      'ì±„ë„ì™€ ëª…ë„',
      'ìƒ‰ê° í‘œí˜„',
    ]
  },
  composition: {
    name: 'êµ¬ë„',
    skills: [
      'í™©ê¸ˆë¹„ìœ¨',
      'ì‹œì„  ìœ ë„',
      'ê· í˜•ê³¼ ëŒ€ë¹„',
      'ê³µê°„ ë°°ì¹˜',
    ]
  }
};

const DAYS_OF_WEEK = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];

// ============================================
// ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
// ============================================

const generateId = () => Math.random().toString(36).substr(2, 9);

// ============================================
// ìŠ¤í† ë¦¬ì§€ ê´€ë¦¬ (React State ê¸°ë°˜)
// ============================================

const useLocalStorage = (key, initialValue) => {
  const [storedValue, setStoredValue] = useState(() => {
    try {
      const item = localStorage.getItem(key);
      return item ? JSON.parse(item) : initialValue;
    } catch (error) {
      console.log(error);
      return initialValue;
    }
  });

  const setValue = (value) => {
    try {
      const valueToStore = value instanceof Function ? value(storedValue) : value;
      setStoredValue(valueToStore);
      localStorage.setItem(key, JSON.stringify(valueToStore));
    } catch (error) {
      console.log(error);
    }
  };

  return [storedValue, setValue];
};

// ============================================
// AI API ì—°ë™ ëª¨ë“ˆ
// ============================================

const AIService = {
  async generateStudyPlan(apiKey, skillLevels, preferences) {
    const prompt = `ë‹¹ì‹ ì€ ë¯¸ìˆ  êµìœ¡ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ë‹¤ìŒ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ 1ì£¼ì¼ í•™ìŠµ í”Œëœì„ JSON í˜•ì‹ìœ¼ë¡œ ìƒì„±í•´ì£¼ì„¸ìš”.

ì‹¤ë ¥ ìˆ˜ì¤€: ${JSON.stringify(skillLevels)}
ì„ í˜¸ì‚¬í•­: ${preferences}

ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš” (JSONë§Œ, ë‹¤ë¥¸ í…ìŠ¤íŠ¸ ì—†ì´):
{
  "weeklyGoal": "ì´ë²ˆ ì£¼ ëª©í‘œ",
  "dailyTasks": [
    {
      "day": "ì›”",
      "tasks": [
        {
          "title": "ê³¼ì œ ì œëª©",
          "description": "ìƒì„¸ ì„¤ëª…",
          "duration": "30ë¶„",
          "difficulty": "easy"
        }
      ]
    }
  ],
  "resources": [
    {
      "title": "ë¦¬ì†ŒìŠ¤ ì œëª©",
      "type": "video",
      "url": "https://youtube.com/watch?v=example",
      "category": "basic"
    }
  ],
  "strengths": ["ê°•ì 1", "ê°•ì 2"],
  "weaknesses": ["ì•½ì 1", "ì•½ì 2"],
  "tips": ["íŒ1", "íŒ2"]
}`;

    try {
      const response = await fetch('https://api.anthropic.com/v1/messages', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          model: 'claude-sonnet-4-20250514',
          max_tokens: 1000,
          messages: [
            { role: 'user', content: prompt }
          ],
        }),
      });

      const data = await response.json();
      const text = data.content.map(item => item.type === 'text' ? item.text : '').join('\n');
      const cleaned = text.replace(/```json|```/g, '').trim();
      return JSON.parse(cleaned);
    } catch (error) {
      console.error('AI API ì˜¤ë¥˜:', error);
      throw error;
    }
  },

  async getMotivationalMessage(apiKey, progress) {
    const prompt = `ì‚¬ìš©ìì˜ ì§„í–‰ë„ëŠ” ${progress}%ì…ë‹ˆë‹¤. ADHDê°€ ìˆëŠ” ì„±ì¸ í•™ìŠµìë¥¼ ìœ„í•œ ì§§ê³  ê²©ë ¤ì ì¸ ë©”ì‹œì§€ë¥¼ í•œ ë¬¸ì¥ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”. ë”°ëœ»í•˜ê³  êµ¬ì²´ì ì´ì–´ì•¼ í•©ë‹ˆë‹¤.`;

    try {
      const response = await fetch('https://api.anthropic.com/v1/messages', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          model: 'claude-sonnet-4-20250514',
          max_tokens: 1000,
          messages: [
            { role: 'user', content: prompt }
          ],
        }),
      });

      const data = await response.json();
      return data.content[0].text;
    } catch (error) {
      console.error('AI API ì˜¤ë¥˜:', error);
      return 'ì˜¤ëŠ˜ë„ í•œ ê±¸ìŒ ë‚˜ì•„ê°€ê³  ìˆì–´ìš”! ğŸ¨';
    }
  }
};

// ============================================
// ë©”ì¸ ì•± ì»´í¬ë„ŒíŠ¸
// ============================================

export default function ArtStudyApp() {
  // ìƒíƒœ ê´€ë¦¬
  const [currentView, setCurrentView] = useState('home');
  const [apiKey, setApiKey] = useLocalStorage('apiKey', '');
  const [skillLevels, setSkillLevels] = useLocalStorage('skillLevels', {});
  const [studyPlan, setStudyPlan] = useLocalStorage('studyPlan', null);
  const [completedTasks, setCompletedTasks] = useLocalStorage('completedTasks', {});
  const [totalPoints, setTotalPoints] = useLocalStorage('totalPoints', 0);
  const [streak, setStreak] = useLocalStorage('streak', 0);
  const [loading, setLoading] = useState(false);

  // ============================================
  // ì´ˆê¸° ì„¤ì • í™”ë©´
  // ============================================
  
  const SetupView = () => {
    const [tempApiKey, setTempApiKey] = useState(apiKey);
    const [step, setStep] = useState(apiKey ? 2 : 1);
    const [tempSkills, setTempSkills] = useState(skillLevels);

    const handleSkillChange = (category, skill, level) => {
      setTempSkills(prev => ({
        ...prev,
        [`${category}-${skill}`]: level
      }));
    };

    const handleGeneratePlan = async () => {
      setLoading(true);
      try {
        const plan = await AIService.generateStudyPlan(tempApiKey, tempSkills, '');
        setStudyPlan(plan);
        setSkillLevels(tempSkills);
        setApiKey(tempApiKey);
        setCurrentView('home');
      } catch (error) {
        alert('í”Œëœ ìƒì„± ì‹¤íŒ¨. API í‚¤ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
      }
      setLoading(false);
    };

    return (
      <div className="min-h-screen bg-gray-50 p-4">
        <div className="max-w-2xl mx-auto">
          {/* ì§„í–‰ ë‹¨ê³„ í‘œì‹œ */}
          <div className="mb-8 flex items-center justify-center gap-2">
            <div className={`w-8 h-8 rounded-full flex items-center justify-center ${step >= 1 ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}>1</div>
            <div className="w-16 h-1 bg-gray-200"></div>
            <div className={`w-8 h-8 rounded-full flex items-center justify-center ${step >= 2 ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}>2</div>
            <div className="w-16 h-1 bg-gray-200"></div>
            <div className={`w-8 h-8 rounded-full flex items-center justify-center ${step >= 3 ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}>3</div>
          </div>

          {/* Step 1: API í‚¤ ì…ë ¥ */}
          {step === 1 && (
            <div className="bg-white rounded-2xl p-6 shadow-sm">
              <h2 className="text-2xl font-bold mb-2">AI ì—°ê²°í•˜ê¸°</h2>
              <p className="text-gray-600 mb-6">Claude API í‚¤ë¥¼ ì…ë ¥í•˜ì—¬ ê°œì¸í™”ëœ í•™ìŠµ í”Œëœì„ ë°›ì•„ë³´ì„¸ìš”</p>
              
              <input
                type="password"
                value={tempApiKey}
                onChange={(e) => setTempApiKey(e.target.value)}
                placeholder="sk-ant-..."
                className="w-full p-3 border border-gray-200 rounded-lg mb-4"
              />
              
              <button
                onClick={() => setStep(2)}
                disabled={!tempApiKey}
                className="w-full bg-blue-500 text-white py-3 rounded-lg font-medium disabled:opacity-50"
              >
                ë‹¤ìŒ
              </button>
            </div>
          )}

          {/* Step 2: ì‹¤ë ¥ ì²´í¬ë¦¬ìŠ¤íŠ¸ */}
          {step === 2 && (
            <div className="bg-white rounded-2xl p-6 shadow-sm">
              <h2 className="text-2xl font-bold mb-2">í˜„ì¬ ì‹¤ë ¥ ì²´í¬</h2>
              <p className="text-gray-600 mb-6">ê° í•­ëª©ì— ëŒ€í•œ ìì‹ ì˜ ìˆ˜ì¤€ì„ ì„ íƒí•´ì£¼ì„¸ìš”</p>
              
              <div className="space-y-6 max-h-96 overflow-y-auto">
                {Object.entries(SKILL_CATEGORIES).map(([categoryKey, category]) => (
                  <div key={categoryKey} className="border-b pb-4">
                    <h3 className="font-semibold mb-3">{category.name}</h3>
                    {category.skills.map(skill => (
                      <div key={skill} className="mb-3">
                        <p className="text-sm mb-1">{skill}</p>
                        <div className="flex gap-2">
                          {['ì´ˆê¸‰', 'ì¤‘ê¸‰', 'ìƒê¸‰'].map(level => (
                            <button
                              key={level}
                              onClick={() => handleSkillChange(categoryKey, skill, level)}
                              className={`px-3 py-1 rounded-full text-xs ${
                                tempSkills[`${categoryKey}-${skill}`] === level
                                  ? 'bg-blue-500 text-white'
                                  : 'bg-gray-100 text-gray-600'
                              }`}
                            >
                              {level}
                            </button>
                          ))}
                        </div>
                      </div>
                    ))}
                  </div>
                ))}
              </div>
              
              <button
                onClick={() => setStep(3)}
                className="w-full bg-blue-500 text-white py-3 rounded-lg font-medium mt-4"
              >
                ë‹¤ìŒ
              </button>
            </div>
          )}

          {/* Step 3: í”Œëœ ìƒì„± */}
          {step === 3 && (
            <div className="bg-white rounded-2xl p-6 shadow-sm text-center">
              <h2 className="text-2xl font-bold mb-2">ì¤€ë¹„ ì™„ë£Œ!</h2>
              <p className="text-gray-600 mb-6">AIê°€ ë§ì¶¤ í•™ìŠµ í”Œëœì„ ìƒì„±í•©ë‹ˆë‹¤</p>
              
              <button
                onClick={handleGeneratePlan}
                disabled={loading}
                className="w-full bg-blue-500 text-white py-3 rounded-lg font-medium disabled:opacity-50"
              >
                {loading ? 'ìƒì„± ì¤‘...' : 'í•™ìŠµ í”Œëœ ìƒì„±í•˜ê¸°'}
              </button>
            </div>
          )}
        </div>
      </div>
    );
  };

  // ============================================
  // í™ˆ í™”ë©´ - ì˜¤ëŠ˜ì˜ ê³¼ì œ
  // ============================================
  
  const HomeView = () => {
    const today = DAYS_OF_WEEK[new Date().getDay() === 0 ? 6 : new Date().getDay() - 1];
    const todayTasks = studyPlan?.dailyTasks?.find(d => d.day === today)?.tasks || [];
    const completedToday = todayTasks.filter(task => completedTasks[task.title]).length;
    const progress = todayTasks.length > 0 ? Math.round((completedToday / todayTasks.length) * 100) : 0;

    const toggleTask = (taskTitle) => {
      const newCompleted = { ...completedTasks };
      if (newCompleted[taskTitle]) {
        delete newCompleted[taskTitle];
        setTotalPoints(prev => prev - 10);
      } else {
        newCompleted[taskTitle] = new Date().toISOString();
        setTotalPoints(prev => prev + 10);
      }
      setCompletedTasks(newCompleted);
    };

    return (
      <div className="pb-20">
        {/* í—¤ë” - ì§„í–‰ë„ ë° í¬ì¸íŠ¸ */}
        <div className="bg-gradient-to-br from-blue-500 to-purple-600 text-white p-6 rounded-b-3xl">
          <div className="flex justify-between items-center mb-4">
            <div>
              <p className="text-sm opacity-90">ì˜¤ëŠ˜ì˜ ì§„í–‰ë„</p>
              <h1 className="text-3xl font-bold">{progress}%</h1>
            </div>
            <div className="text-right">
              <div className="flex items-center gap-2 mb-1">
                <Star className="w-5 h-5 fill-current" />
                <span className="text-xl font-bold">{totalPoints}</span>
              </div>
              <p className="text-xs opacity-90">{streak}ì¼ ì—°ì†</p>
            </div>
          </div>
          
          {/* ì§„í–‰ë°” */}
          <div className="bg-white/20 rounded-full h-2 overflow-hidden">
            <div 
              className="bg-white h-full transition-all duration-300"
              style={{ width: `${progress}%` }}
            ></div>
          </div>
        </div>

        {/* ì£¼ê°„ ëª©í‘œ */}
        {studyPlan?.weeklyGoal && (
          <div className="mx-4 mt-4 bg-blue-50 border border-blue-100 rounded-xl p-4">
            <div className="flex items-start gap-3">
              <Target className="w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0" />
              <div>
                <p className="text-xs text-blue-600 font-medium mb-1">ì´ë²ˆ ì£¼ ëª©í‘œ</p>
                <p className="text-sm text-gray-800">{studyPlan.weeklyGoal}</p>
              </div>
            </div>
          </div>
        )}

        {/* ì˜¤ëŠ˜ì˜ ê³¼ì œ */}
        <div className="p-4">
          <h2 className="text-lg font-bold mb-3 flex items-center gap-2">
            <Calendar className="w-5 h-5" />
            ì˜¤ëŠ˜ì˜ ê³¼ì œ ({today}ìš”ì¼)
          </h2>
          
          {todayTasks.length === 0 ? (
            <div className="bg-white rounded-xl p-6 text-center text-gray-400">
              <p>ì˜¤ëŠ˜ì€ íœ´ì‹í•˜ëŠ” ë‚ ì´ì—ìš” ğŸ˜Š</p>
            </div>
          ) : (
            <div className="space-y-3">
              {todayTasks.map((task, idx) => (
                <div 
                  key={idx}
                  onClick={() => toggleTask(task.title)}
                  className={`bg-white rounded-xl p-4 shadow-sm cursor-pointer transition-all ${
                    completedTasks[task.title] ? 'opacity-50' : ''
                  }`}
                >
                  <div className="flex items-start gap-3">
                    {completedTasks[task.title] ? (
                      <CheckCircle2 className="w-6 h-6 text-green-500 flex-shrink-0" />
                    ) : (
                      <Circle className="w-6 h-6 text-gray-300 flex-shrink-0" />
                    )}
                    <div className="flex-1">
                      <h3 className="font-semibold mb-1">{task.title}</h3>
                      <p className="text-sm text-gray-600 mb-2">{task.description}</p>
                      <div className="flex items-center gap-3 text-xs text-gray-500">
                        <span>â±ï¸ {task.duration}</span>
                        <span className={`px-2 py-0.5 rounded-full ${
                          task.difficulty === 'easy' ? 'bg-green-100 text-green-700' :
                          task.difficulty === 'medium' ? 'bg-yellow-100 text-yellow-700' :
                          'bg-red-100 text-red-700'
                        }`}>
                          {task.difficulty === 'easy' ? 'ì‰¬ì›€' : task.difficulty === 'medium' ? 'ë³´í†µ' : 'ì–´ë ¤ì›€'}
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          )}
        </div>
      </div>
    );
  };

  // ============================================
  // ë¶„ì„ í™”ë©´ - ê°•ì /ì•½ì 
  // ============================================
  
  const AnalysisView = () => {
    return (
      <div className="p-4 pb-20">
        <h2 className="text-2xl font-bold mb-4">ë‚˜ì˜ ë¶„ì„</h2>
        
        {/* ê°•ì  */}
        <div className="bg-green-50 rounded-xl p-4 mb-4">
          <h3 className="font-semibold text-green-800 mb-2 flex items-center gap-2">
            <TrendingUp className="w-5 h-5" />
            ê°•ì 
          </h3>
          <ul className="space-y-1">
            {studyPlan?.strengths?.map((strength, idx) => (
              <li key={idx} className="text-sm text-gray-700">â€¢ {strength}</li>
            ))}
          </ul>
        </div>

        {/* ê°œì„  ì˜ì—­ */}
        <div className="bg-orange-50 rounded-xl p-4 mb-4">
          <h3 className="font-semibold text-orange-800 mb-2 flex items-center gap-2">
            <Target className="w-5 h-5" />
            ê°œì„  ì˜ì—­
          </h3>
          <ul className="space-y-1">
            {studyPlan?.weaknesses?.map((weakness, idx) => (
              <li key={idx} className="text-sm text-gray-700">â€¢ {weakness}</li>
            ))}
          </ul>
        </div>

        {/* í•™ìŠµ íŒ */}
        <div className="bg-blue-50 rounded-xl p-4">
          <h3 className="font-semibold text-blue-800 mb-2 flex items-center gap-2">
            <Award className="w-5 h-5" />
            í•™ìŠµ íŒ
          </h3>
          <ul className="space-y-1">
            {studyPlan?.tips?.map((tip, idx) => (
              <li key={idx} className="text-sm text-gray-700">â€¢ {tip}</li>
            ))}
          </ul>
        </div>
      </div>
    );
  };

  // ============================================
  // ë¦¬ì†ŒìŠ¤ í™”ë©´ - ì¶”ì²œ í•™ìŠµ ìë£Œ
  // ============================================
  
  const ResourcesView = () => {
    return (
      <div className="p-4 pb-20">
        <h2 className="text-2xl font-bold mb-4">ì¶”ì²œ í•™ìŠµ ìë£Œ</h2>
        
        <div className="space-y-3">
          {studyPlan?.resources?.map((resource, idx) => (
            <a
              key={idx}
              href={resource.url}
              target="_blank"
              rel="noopener noreferrer"
              className="block bg-white rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow"
            >
              <div className="flex items-start gap-3">
                <BookOpen className="w-5 h-5 text-blue-500 mt-0.5 flex-shrink-0" />
                <div className="flex-1">
                  <h3 className="font-semibold mb-1">{resource.title}</h3>
                  <p className="text-xs text-gray-500">
                    {resource.type === 'video' ? 'ğŸ“¹ ì˜ìƒ' : 'ğŸ“„ ë¬¸ì„œ'} â€¢ {SKILL_CATEGORIES[resource.category]?.name}
                  </p>
                </div>
              </div>
            </a>
          ))}
        </div>
      </div>
    );
  };

  // ============================================
  // ì„¤ì • í™”ë©´
  // ============================================
  
  const SettingsView = () => {
    const handleReset = () => {
      if (confirm('ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        setApiKey('');
        setSkillLevels({});
        setStudyPlan(null);
        setCompletedTasks({});
        setTotalPoints(0);
        setStreak(0);
        setCurrentView('setup');
      }
    };

    return (
      <div className="p-4 pb-20">
        <h2 className="text-2xl font-bold mb-4">ì„¤ì •</h2>
        
        <div className="space-y-3">
          <button
            onClick={() => setCurrentView('setup')}
            className="w-full bg-white rounded-xl p-4 shadow-sm text-left hover:shadow-md transition-shadow"
          >
            <p className="font-semibold">ì‹¤ë ¥ ì¬í‰ê°€</p>
            <p className="text-sm text-gray-600">ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ë‹¤ì‹œ ì‘ì„±í•©ë‹ˆë‹¤</p>
          </button>
          
          <button
            onClick={handleReset}
            className="w-full bg-red-50 text-red-600 rounded-xl p-4 shadow-sm text-left hover:shadow-md transition-shadow"
          >
            <p className="font-semibold">ë°ì´í„° ì´ˆê¸°í™”</p>
            <p className="text-sm">ëª¨ë“  ì§„í–‰ ìƒí™©ì´ ì‚­ì œë©ë‹ˆë‹¤</p>
          </button>
        </div>
      </div>
    );
  };

  // ============================================
  // í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°”
  // ============================================
  
  const BottomNav = () => {
    const navItems = [
      { id: 'home', icon: Home, label: 'í™ˆ' },
      { id: 'analysis', icon: TrendingUp, label: 'ë¶„ì„' },
      { id: 'resources', icon: BookOpen, label: 'ìë£Œ' },
      { id: 'settings', icon: Settings, label: 'ì„¤ì •' },
    ];

    return (
      <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-2">
        <div className="max-w-2xl mx-auto flex justify-around">
          {navItems.map(item => (
            <button
              key={item.id}
              onClick={() => setCurrentView(item.id)}
              className={`flex flex-col items-center gap-1 py-2 px-4 rounded-lg transition-colors ${
                currentView === item.id ? 'text-blue-600' : 'text-gray-400'
              }`}
            >
              <item.icon className="w-6 h-6" />
              <span className="text-xs">{item.label}</span>
            </button>
          ))}
        </div>
      </div>
    );
  };

  // ============================================
  // ë©”ì¸ ë Œë”ë§
  // ============================================
  
  if (!studyPlan) {
    return <SetupView />;
  }

  return (
    <div className="min-h-screen bg-gray-50">
      {currentView === 'home' && <HomeView />}
      {currentView === 'analysis' && <AnalysisView />}
      {currentView === 'resources' && <ResourcesView />}
      {currentView === 'settings' && <SettingsView />}
      {currentView === 'setup' && <SetupView />}
      <BottomNav />
    </div>
  );
}
